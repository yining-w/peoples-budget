<<<<<<< HEAD
---
title: "pairwise data"
author: "Yi Ning"
date: "10/27/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo= TRUE)
library(kableExtra)
library(RColorBrewer)
library(tidyverse)
library(viridis)
rm(list=ls())
pairwise = read.csv("~/GitHub/Peoples Budget Viz/peoples-budget-viz/visualize/csvs/Peoples_Budget_wikisurvey_results.csv")
```

Set up

```{r cars}
head(pairwise)

##create rank by theme
pairwise = 
  pairwise %>% group_by(Idea_Category) %>% 
      mutate(group_rank = order(AOI_web_score, decreasing=TRUE))

pairwise = pairwise[
  with(pairwise, order(Idea_Category, group_rank, Ranking)),
]

##create a table for english
pairwise_eng = subset(pairwise, select = c(Idea_Category,Idea_Text, Ranking, group_rank, AOI_web_score, total_matches))

##create a table for spanish
pairwise_spanish = subset(pairwise, select = c(Idea_Category,Idea_ES, Ranking, group_rank, AOI_web_score, total_matches))

```

Make summary tables for the ideas
```{r pressure, echo=FALSE}
colnames(pairwise_eng) = c("Theme", "Idea", "Rank", "Group_Rank", "Score", "Total Matches")
kbl(pairwise_eng) %>%
  kable_styling(bootstrap_options = c("striped", "hover")) %>%
    save_kable("pairwise_eng.pdf")

colnames(pairwise_spanish) = c("Theme", "Idea", "Rank", "Group_Rank", "Score", "Total Matches")
kbl(pairwise_spanish) %>%
  kable_styling(bootstrap_options = c("striped", "hover")) %>%
    save_kable("pairwise_spanish.pdf")


```
Plot by theme
```{r}
pairwise_eng %>%
  ggplot(aes(y = Score, x=Rank)) +
  geom_hline(aes(yintercept=median(Score)), line = "dashed") +
  geom_point(aes(colour=factor(Rank))) +
  scale_fill_viridis(discrete = TRUE, option="magma") +
  facet_wrap(~Theme) + 
  theme_minimal() + 
  labs(title="All of the Ideas Visualized by Category",
       subtitle = "Each dot represents an idea. The higher the dot, the higher its score/ 
The further right the dot the higher its rank. The horizontal line indicates the median score.",
       caption = "The People's Budget Chicago",
       x = "Rank", y = "Score") + 
  theme(legend.position = "none") 

ggsave("~/GitHub/Peoples Budget Viz/peoples-budget-viz/visualize/output/pairwise.png")

  
```
  
=======
